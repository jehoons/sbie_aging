# -*- coding: utf-8 -*-
#*************************************************************************
# Author: {Je-Hoon Song, <song.je-hoon@kaist.ac.kr>
#
# This file is part of {lab}.
#*************************************************************************
from os.path import dirname, join, exists 
from ipdb import set_trace 
import glob
import re 

__all__ = ['table_s1', 'table_s2']

def update_toc(): 
	dir_result = dirname(__file__)

	p_h3 = re.compile(r'### Table')
	p_h4 = re.compile(r'#### \([A-Z*]+\)')

	s = r'' 

	encoding = 'utf-8'

	with open(join(dir_result, 'README.md'), 'w', encoding=encoding) as fout: 
		fout.write(r'> Do not edit this file manually. This file is updated automatically.')
		fout.write('\n\n')
		fout.write(r'### Results')
		fout.write('\n')
		for folder in __all__: 
			readmefile = join(dir_result, folder, 'README.md')
			toc = {'h3': None, 'h4': []}
			with open(readmefile, 'r', encoding=encoding) as f: 
				content = f.readlines()
				# set_trace()
				for aline in content: 
					if p_h3.match(aline) != None: 
						toc['h3'] = aline[4:].strip()
					if p_h4.match(aline) != None:
						toc['h4'].append(aline[5:].strip())

			fout.write(r'#### [%s](%s)' % (toc['h3'], folder))
			fout.write('\n')
			fout.write(r' '.join(toc['h4']))
			fout.write('\n')
			